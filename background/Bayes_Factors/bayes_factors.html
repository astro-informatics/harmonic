<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bayes factors &mdash; Harmonic 1.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=798747b0" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom_tabs.css?v=82e1095b" />
      <link rel="stylesheet" type="text/css" href="../../_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="../../_static/dark_mode_css/dark.css?v=70edf1c7" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=6efca38a"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../../_static/dark_mode_js/default_light.js?v=c2e647ce"></script>
        <script src="../../_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Log-space variance" href="../Log_space_statistics/log_variance.html" />
    <link rel="prev" title="Learning a suitable target distribution" href="../Machine_Learning/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/harm_badge_simple.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/install.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Harmonic_Estimator/original_harmonic_mean.html">Harmonic mean estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Harmonic_Estimator/retargetd_harmonic_mean.html">Re-targeted harmonic mean estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Harmonic_Estimator/learnt_harmonic_mean.html">Learnt harmonic mean estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Machine_Learning/index.html">Learning a suitable target distribution</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Bayes factors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Log_space_statistics/log_variance.html">Log-space variance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/basic_usage.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/checkpointing.html">Checkpointing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">Namespaces</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Harmonic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Bayes factors</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/background/Bayes_Factors/bayes_factors.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bayes-factors">
<h1>Bayes factors<a class="headerlink" href="#bayes-factors" title="Link to this heading">ÔÉÅ</a></h1>
<p>We have so far considered the estimation of the reciprocal marginal likelihood and related variances only.  However, it is the marginal likelihood itself (not its reciprocal), or the Bayes factors computed to compare two models, that is typically of direct interest.  We therefore consider how to compute these quantities of interest and a measure of their variance (as discussed in <a class="reference external" href="https://arxiv.org/abs/2111.12720">McEwen et al. 2021</a>).</p>
<p>First, consider the mean and variance of the function <span class="math notranslate nohighlight">\(f(X,Y) = X/Y\)</span> of two uncorrelated random variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, which by Taylor expansion to second order are given by</p>
<div class="math notranslate nohighlight">
\[\mathbb{E}\biggl(\frac{X}{Y}\biggr) \simeq \frac{\mathbb{E}(X)}{\mathbb{E}(Y)} + \frac{\mathbb{E}(X)}{\mathbb{E}(Y)^3} \sigma_Y^2\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\text{var}\biggl(\frac{X}{Y}\biggr) \simeq \frac{1}{\mathbb{E}(Y)^2} \sigma_X^2 + \frac{\mathbb{E}(X)^2}{\mathbb{E}(Y)^4} \sigma_Y^2,\]</div>
<p>respectively, where <span class="math notranslate nohighlight">\(\sigma_X = \mathbb{E}\bigl[ (X - \mathbb{E}(X))^2 \bigr]\)</span> and <span class="math notranslate nohighlight">\(\sigma_Y = \mathbb{E}\bigl[ (Y - \mathbb{E}(Y))^2 \bigr]\)</span>.</p>
<p>Using this result the marginal likelihood and its variance can be estimated from the reciprocal estimators by making use of the relations</p>
<div class="math notranslate nohighlight">
\[\mathbb{E}( z )
= \mathbb{E}\biggl(\frac{1}{{\rho}}\biggr)
\simeq \frac{1}{\mathbb{E}({\rho})} \biggl( 1 + \frac{\sigma_{\rho}^2}{\mathbb{E}({\rho})^2} \biggr)
\qquad \quad\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\text{var}(z) =
\text{var}\biggl(\frac{1}{{\rho}}\biggr)
\simeq \frac{\sigma_{\rho}^2}{\mathbb{E}({\rho})^4},\]</div>
<p>respectively, by considering the case <span class="math notranslate nohighlight">\(X=1\)</span> and <span class="math notranslate nohighlight">\(Y = \rho\)</span>.  These expressions are computed (in log space) in <code class="docutils literal notranslate"><span class="pre">harmonic</span></code> by the <code class="code docutils literal notranslate"><span class="pre">Evidence.compute_ln_evidence</span></code> method.</p>
<p>Typically it is the Bayes factor given by the ratio of marginal likelihoods that is of most interest in order to compare models.  Again using the expressions above for the mean and variance of the function <span class="math notranslate nohighlight">\(f(X,Y) = X/Y\)</span>, this time for the case <span class="math notranslate nohighlight">\(X = \rho_2\)</span> and <span class="math notranslate nohighlight">\(Y = \rho_1\)</span>, the Bayes factor and its variance can be estimated directly from the reciprocal marginal likelihood estimates and variances by making use of the relations</p>
<div class="math notranslate nohighlight">
\[\mathbb{E}\biggl(\frac{z_1}{z_2}\biggr)
=
\mathbb{E}\biggr(\frac{\rho_2}{\rho_1}\biggr)
\simeq
\frac{\mathbb{E}({\rho_2})}{\mathbb{E}({\rho_1})}
\biggl( 1 + \frac{\sigma_{\rho_1}^2}{\mathbb{E}({\rho_1})^2}  \biggr)\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\text{var}\biggl(\frac{z_1}{z_2}\biggr)
=
\text{var}\biggl(\frac{{\rho_2}}{{\rho_1}}\biggr)
\simeq
\frac{\mathbb{E}({\rho_1})^2 \sigma_{\rho_2}^2+ \mathbb{E}({\rho_2})^2 \sigma_{\rho_1}^2}{\mathbb{E}({\rho_1})^4},\]</div>
<p>respectively.  These expressions are computed (in log space) in <code class="docutils literal notranslate"><span class="pre">harmonic</span></code> by the <code class="code docutils literal notranslate"><span class="pre">evidence.compute_ln_bayes_factor</span></code> function.</p>
<p>While we compute log quantities, as discussed above, the variance computed (i.e. error estimate) is related to the evidence itself (not the log evidence).  We consider how to compute an error estimate for the log evidence in the section <a class="reference internal" href="../Log_space_statistics/log_variance.html#logvar"><span class="std std-ref">Log-space variance</span></a>.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../Machine_Learning/index.html" class="btn btn-neutral float-left" title="Learning a suitable target distribution" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Log_space_statistics/log_variance.html" class="btn btn-neutral float-right" title="Log-space variance" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Jason D. McEwen, Christopher G. R. Wallis, Matthew A. Price, Matthew M. Docherty, Alicja Polanska.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>