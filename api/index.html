<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Namespaces &mdash; Harmonic 1.1.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom_tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/dark_mode_css/general.css" type="text/css" />
      <link rel="stylesheet" href="../_static/dark_mode_css/dark.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/tabs.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script src="../_static/dark_mode_js/default_light.js"></script>
        <script src="../_static/dark_mode_js/theme_switcher.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Checkpointing" href="../tutorials/checkpointing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/harm_badge_simple.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/install.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../background/Harmonic_Estimator/original_harmonic_mean.html">Harmonic mean estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Harmonic_Estimator/retargetd_harmonic_mean.html">Re-targeted harmonic mean estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Harmonic_Estimator/learnt_harmonic_mean.html">Learnt harmonic mean estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Machine_Learning/index.html">Learning a suitable target distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Bayes_Factors/bayes_factors.html">Bayes factors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Log_space_statistics/log_variance.html">Log-space variance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/basic_usage.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cross-validation_hyper-parameters.html">Hyper-parameter cross-validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cross-validation_learnt_model.html">Model cross-validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/checkpointing.html">Checkpointing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Namespaces</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Harmonic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Namespaces</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="namespaces">
<h1>Namespaces<a class="headerlink" href="#namespaces" title="Permalink to this headline"></a></h1>
<p>Automatically generated documentation for <strong>harmonic</strong> APIs. All functionality is accessible through a pip installation of the <strong>harmonic</strong> package.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">Chains</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">Evidence</button><button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">Model</button><button aria-controls="panel-0-0-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-3" name="0-3" role="tab" tabindex="-1">Logs</button><button aria-controls="panel-0-0-4" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-4" name="0-4" role="tab" tabindex="-1">Utilities</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><dl class="py class">
<dt class="sig sig-object py" id="harmonic.Chains">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">harmonic.</span></span><span class="sig-name descname"><span class="pre">Chains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains" title="Permalink to this definition"></a></dt>
<dd><p>Class to store samples from multiple MCMC chains.</p>
<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Construct empty Chains for parameter space of dimension ndim.</p>
<p>Constructor simply sets ndim. Chain samples are added by the add_chain*
methods since we want to support setting up data for chains from
different input data formats (e.g. data from a single chain or multiple
chains at once).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ndim</strong> (<em>int</em>) – Dimension of the parameter space.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.add" title="Permalink to this definition"></a></dt>
<dd><p>Add other Chain object to this object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#harmonic.Chains" title="harmonic.Chains"><em>Chains</em></a>) – Other Chain object to be added to this object.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if the new chain has a different ndim.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.add_chain">
<span class="sig-name descname"><span class="pre">add_chain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ln_posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.add_chain" title="Permalink to this definition"></a></dt>
<dd><p>Add a single chain to a Chains object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em><em>[</em><em>nsamples</em><em>, </em><em>ndim</em><em>]</em>) – Samples of a single
chain.</p></li>
<li><p><strong>ln_posterior</strong> (<em>np.ndarray</em><em>[</em><em>n_new_samples</em><em>]</em>) – log_e posterior
values.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised when ndim of new chain does not match previous
    chains.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.add_chains_2d">
<span class="sig-name descname"><span class="pre">add_chains_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ln_posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchains_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.add_chains_2d" title="Permalink to this definition"></a></dt>
<dd><p>Add a number of chains to a Chains object assuming all chains are
of the same length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em><em>[</em><em>nsamples_in * nchains_in</em><em>, </em><em>ndim</em><em>]</em>) – Samples
of multiple chains.</p></li>
<li><p><strong>ln_posterior</strong> (<em>np.ndarray</em><em>[</em><em>nsamples_in * nchains_in</em><em>]</em>) – log_e
posterior values.</p></li>
<li><p><strong>nchains_in</strong> (<em>int</em>) – Number of chains to be added.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised when number of samples is not multiple of the
    number of chains.</p></li>
<li><p><strong>ValueError</strong> – Raised when ndim of new chains does not match previous
    chains.</p></li>
<li><p><strong>ValueError</strong> – Raised when posterior and samples first length are
    different.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.add_chains_2d_list">
<span class="sig-name descname"><span class="pre">add_chains_2d_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ln_posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchains_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_indexes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.add_chains_2d_list" title="Permalink to this definition"></a></dt>
<dd><p>Add a number of chains to the chain class. Uses a list of indexes to
determine where each chain starts and stops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em><em>[</em><em>nsamples_in * nchains_in</em><em>, </em><em>ndim</em><em>]</em>) – Samples
of multiple chains.</p></li>
<li><p><strong>ln_posterior</strong> (<em>np.ndarray</em><em>[</em><em>nsamples_in * nchains_in</em><em>]</em>) – log_e
posterior values.</p></li>
<li><p><strong>nchains_in</strong> (<em>int</em>) – Number of chains to be added.</p></li>
<li><p><strong>chain_indexes</strong> (<em>list</em>) – List of the starting index of the chains.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised when ndim of new chains does not match
    previous chains.</p></li>
<li><p><strong>ValueError</strong> – Raised when posterior and samples first length are
    different.</p></li>
<li><p><strong>ValueError</strong> – Raised when the length of the list is not nchains_in
    + 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.add_chains_3d">
<span class="sig-name descname"><span class="pre">add_chains_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ln_posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.add_chains_3d" title="Permalink to this definition"></a></dt>
<dd><p>Add a number of chains to a Chain object from 3D array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em><em>[</em><em>nchains_in</em><em>, </em><em>nsamples_in</em><em>, </em><em>ndim</em><em>]</em>) – Samples
from multiple chains.</p></li>
<li><p><strong>ln_posterior</strong> (<em>np.ndarray</em><em>[</em><em>nchains_in</em><em>, </em><em>nsamples_in</em><em>]</em>) – log_e
posterior values.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised when ndim of new chains does not match previous
    chains.</p></li>
<li><p><strong>ValueError</strong> – Raised when posterior and samples first and second
    length are different.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.deepcopy">
<span class="sig-name descname"><span class="pre">deepcopy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.deepcopy" title="Permalink to this definition"></a></dt>
<dd><p>Performs deep copy of the chain class (calls the module copy).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.get_chain_indices">
<span class="sig-name descname"><span class="pre">get_chain_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.get_chain_indices" title="Permalink to this definition"></a></dt>
<dd><p>Gets the start and end index of samples from a chain.</p>
<p>The end index specifies the index one passed the end of the chain, i.e.
the chain samples can be accessed by self.samples[start:end,:].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> (<em>int</em>) – Index of chain of which to determine start and end indices.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of the start and end index, i.e. (start, end).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(int, int)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised when chain number invalid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.get_sub_chains">
<span class="sig-name descname"><span class="pre">get_sub_chains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chains_wanted</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.get_sub_chains" title="Permalink to this definition"></a></dt>
<dd><p>Creates a new chain instance with the chains indexed in chains_wanted.
(Useful for cross-validation.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chains_wanted</strong> (<em>List</em>) – List of indexes of chains that the new
chain instance will contain.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Chains object containing the chains wanted.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#harmonic.Chains" title="harmonic.Chains">Chains</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the chains_wanted indexes are out of bounds
    i.e. outside of range 0 to nchains - 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.nsamples_per_chain">
<span class="sig-name descname"><span class="pre">nsamples_per_chain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.nsamples_per_chain" title="Permalink to this definition"></a></dt>
<dd><p>Compute list containing number of samples in each chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None.</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>1D list of length self.nchains containing the</dt><dd><p>number of samples in each chain.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nsamples_per_chain (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.remove_burnin">
<span class="sig-name descname"><span class="pre">remove_burnin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nburn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.remove_burnin" title="Permalink to this definition"></a></dt>
<dd><p>Remove burn-in samples from each chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nburn</strong> (<em>int</em>) – Number of burn-in samples to remove from each chain.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised when nburn not less then number of samples in
    each chain.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.shallowcopy">
<span class="sig-name descname"><span class="pre">shallowcopy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.shallowcopy" title="Permalink to this definition"></a></dt>
<dd><p>Performs shallow copy of the chain class (calls the module copy).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.split_into_blocks">
<span class="sig-name descname"><span class="pre">split_into_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nblocks</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.split_into_blocks" title="Permalink to this definition"></a></dt>
<dd><p>Split chains into larger number of blocks.</p>
<p>The intention of this method is to break chains into blocks that are
(approximately) independent in order to get more independent chains for
computing various statistics.</p>
<p>Each existing chain is split into blocks (i.e. new chains),
proportionally to the size of the current chains. Final blocks within
each chain end up containing slightly different numbers of samples
(since we do not ever want to throw away samples!). One could improve
this, if required, to distribute the additional samples across all of
the blocks of the chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nblocks</strong> (<em>int</em>) – Number of new (blocked) chains to split existing chains
into.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Returned if nblocks &lt; the number chains</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><dl class="py class">
<dt class="sig sig-object py" id="harmonic.Evidence">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">harmonic.</span></span><span class="sig-name descname"><span class="pre">Evidence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nchains</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Shifting.MEAN_SHIFT</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence" title="Permalink to this definition"></a></dt>
<dd><p>Compute inverse evidence values from chains, using posterior model.</p>
<p>Multiple chains can be added in sequence (to avoid having to store very
long chains).</p>
<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nchains</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Shifting.MEAN_SHIFT</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Construct evidence class for computing inverse evidence values from
set number of chains and initialised posterior model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nchains</strong> (<em>int</em>) – Number of chains that will be used in the
computation.</p></li>
<li><p><strong>model</strong> (<em>Model</em>) – An instance of a posterior model class that has
been fitted.</p></li>
<li><p><strong>shift</strong> (<a class="reference internal" href="#harmonic.Shifting" title="harmonic.Shifting"><em>Shifting</em></a>) – What shifting method to use to avoid over/underflow during
computation. Selected from enumerate class.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the number of chains is not positive.</p></li>
<li><p><strong>ValueError</strong> – Raised if the number of dimensions is not positive.</p></li>
<li><p><strong>ValueError</strong> – Raised if model not fitted.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.add_chains">
<span class="sig-name descname"><span class="pre">add_chains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chains</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.add_chains" title="Permalink to this definition"></a></dt>
<dd><p>Add new chains and calculate an estimate of the inverse evidence, its
variance, and the variance of the variance.</p>
<p>Calculations are performed by using running averages of the totals for
each chain. Consequently, the method can be called many times with new
samples for each chain so that the evidence estimate will improve. The
rationale is that not all samples need to be stored in memory for
high-dimensional problems.  Note that the same number of chains needs to
be considered for each call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chains</strong> (<a class="reference internal" href="#harmonic.Chains" title="harmonic.Chains"><em>Chains</em></a>) – An instance of the chains class containing the chains to
be used in the calculation.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the input number of chains to not match the
    number of chains already set up.</p></li>
<li><p><strong>ValueError</strong> – Raised if both max and mean shift are set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.check_basic_diagnostic">
<span class="sig-name descname"><span class="pre">check_basic_diagnostic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.check_basic_diagnostic" title="Permalink to this definition"></a></dt>
<dd><p>Perform basic diagonstic check on sanity of evidence calculations.</p>
<p>If these tests pass it does <em>not</em> necessarily mean the evidence is
accurate and other tests should still be performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether diagnostic tests pass.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Boolean</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>Warnings</strong> – Raised if the diagnostic tests fail.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.compute_evidence">
<span class="sig-name descname"><span class="pre">compute_evidence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.compute_evidence" title="Permalink to this definition"></a></dt>
<dd><p>Compute evidence from the inverse evidence.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>Tuple containing the following.</p>
<blockquote>
<div><ul class="simple">
<li><p>evidence (double): Estimate of evidence.</p></li>
<li><p>evidence_std (double): Estimate of standard deviation of
evidence.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(double, double)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.compute_ln_evidence">
<span class="sig-name descname"><span class="pre">compute_ln_evidence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.compute_ln_evidence" title="Permalink to this definition"></a></dt>
<dd><p>Compute log_e of evidence from the inverse evidence.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>Tuple containing the following.</p>
<blockquote>
<div><ul class="simple">
<li><p>ln_evidence (double): Estimate of log_e of evidence.</p></li>
<li><dl class="simple">
<dt>ln_evidence_std (double): Estimate of log_e of standard</dt><dd><p>deviation of evidence.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(double, double)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.compute_ln_inv_evidence_errors">
<span class="sig-name descname"><span class="pre">compute_ln_inv_evidence_errors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.compute_ln_inv_evidence_errors" title="Permalink to this definition"></a></dt>
<dd><p>Compute lower and uppper errors on the log_e of the inverse evidence.</p>
<p>Compute the log-space error <span class="math notranslate nohighlight">\(\hat{\zeta}_\pm\)</span> defined by</p>
<div class="math notranslate nohighlight">
\[\log ( \hat{\rho} \pm \hat{\sigma} ) = \log (\hat{\rho}) + \hat{\zeta}_\pm .\]</div>
<p>Computed in a numerically stable way by</p>
<div class="math notranslate nohighlight">
\[\hat{\zeta}_\pm = \log(1 \pm \hat{\sigma} / \hat{\rho}) .\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>Tuple containing the following.</p>
<blockquote>
<div><ul class="simple">
<li><p>ln_evidence_err_neg (double): Lower error for log_e of inverse evidence.</p></li>
<li><p>ln_evidence_err_pos (double): Upper error for log_e of inverse evidence.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(double, double)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.deserialize">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">deserialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.deserialize" title="Permalink to this definition"></a></dt>
<dd><p>Deserialize Evidence object from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>string</em>) – Name of file from which to read evidence object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evidence object deserialized from file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference internal" href="#harmonic.Evidence" title="harmonic.Evidence">Evidence</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.get_masks">
<span class="sig-name descname"><span class="pre">get_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain_start_ixs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">jax.Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="headerlink" href="#harmonic.Evidence.get_masks" title="Permalink to this definition"></a></dt>
<dd><p>Create mask array for a 2D array of concatenated chains of different lengths.
:param chain_start_ixs: Start indices of chains</p>
<blockquote>
<div><p>in Chain object.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Mask array with each row corresponding to a chain</dt><dd><p>and entries with boolean values depending on if given sample at that
position is in that chain.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>jnp.ndarray[nchains,nsamples]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.process_run">
<span class="sig-name descname"><span class="pre">process_run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.process_run" title="Permalink to this definition"></a></dt>
<dd><p>Use the running totals of realspace running_sum and nsamples_per_chain to
calculate an estimate of the inverse evidence, its variance, and the
variance of the variance.</p>
<p>This method is ran each time chains are added to update the inverse
variance estimates from the running totals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.serialize">
<span class="sig-name descname"><span class="pre">serialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.serialize" title="Permalink to this definition"></a></dt>
<dd><p>Serialize evidence object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>string</em>) – Name of file to save evidence object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.set_shift">
<span class="sig-name descname"><span class="pre">set_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shift_value</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.set_shift" title="Permalink to this definition"></a></dt>
<dd><p>Set the shift value of log_e posterior values to aid numerical stability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shift_value</strong> (<em>float</em>) – Shift value.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if shift_value is NaN.</p></li>
<li><p><strong>ValueError</strong> – Raised if one attempts to set shift when another
    shift is already set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="harmonic.Shifting">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">harmonic.</span></span><span class="sig-name descname"><span class="pre">Shifting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Shifting" title="Permalink to this definition"></a></dt>
<dd><p>Enumeration to define which log-space shifting to adopt. Different choices
may prove optimal for certain settings.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="harmonic.Shifting.ABS_MAX_SHIFT">
<span class="sig-name descname"><span class="pre">ABS_MAX_SHIFT</span></span><em class="property"> <span class="pre">=</span> <span class="pre">4</span></em><a class="headerlink" href="#harmonic.Shifting.ABS_MAX_SHIFT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="harmonic.Shifting.MAX_SHIFT">
<span class="sig-name descname"><span class="pre">MAX_SHIFT</span></span><em class="property"> <span class="pre">=</span> <span class="pre">2</span></em><a class="headerlink" href="#harmonic.Shifting.MAX_SHIFT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="harmonic.Shifting.MEAN_SHIFT">
<span class="sig-name descname"><span class="pre">MEAN_SHIFT</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1</span></em><a class="headerlink" href="#harmonic.Shifting.MEAN_SHIFT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="harmonic.Shifting.MIN_SHIFT">
<span class="sig-name descname"><span class="pre">MIN_SHIFT</span></span><em class="property"> <span class="pre">=</span> <span class="pre">3</span></em><a class="headerlink" href="#harmonic.Shifting.MIN_SHIFT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<span class="target" id="module-harmonic.evidence"></span><dl class="py function">
<dt class="sig sig-object py" id="harmonic.evidence.compute_bayes_factor">
<span class="sig-prename descclassname"><span class="pre">harmonic.evidence.</span></span><span class="sig-name descname"><span class="pre">compute_bayes_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ev1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ev2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.evidence.compute_bayes_factor" title="Permalink to this definition"></a></dt>
<dd><p>Compute Bayes factor of two models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ev1</strong> (<em>float</em>) – Evidence value of model 1 with chains added.</p></li>
<li><p><strong>ev2</strong> (<em>float</em>) – Evidence value of model 2 with chains added.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple containing the following.</p>
<blockquote>
<div><ul class="simple">
<li><p>bf12: Estimate of the Bayes factor Z_1 / Z_2.</p></li>
<li><dl class="simple">
<dt>bf12_std: Estimate of the standard deviation of the Bayes factor</dt><dd><p>sqrt( var ( Z_1 / Z_2 ) ).</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(float, float)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if model 1 does not have chains added.</p></li>
<li><p><strong>ValueError</strong> – Raised if model 2 does not have chains added.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="harmonic.evidence.compute_ln_bayes_factor">
<span class="sig-prename descclassname"><span class="pre">harmonic.evidence.</span></span><span class="sig-name descname"><span class="pre">compute_ln_bayes_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ev1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ev2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.evidence.compute_ln_bayes_factor" title="Permalink to this definition"></a></dt>
<dd><p>Computes log_e of Bayes factor of two models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ev1</strong> (<em>float</em>) – Evidence object of model 1 with chains added.</p></li>
<li><p><strong>ev2</strong> (<em>float</em>) – Evidence object of model 2 with chains added.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple containing the following.</p>
<blockquote>
<div><ul class="simple">
<li><p>ln_bf12: Estimate of log_e of the Bayes factor ln ( Z_1 / Z_2 ).</p></li>
<li><dl class="simple">
<dt>ln_bf12_std: Estimate of log_e of the standard deviation of the</dt><dd><p>Bayes factor ln ( sqrt( var ( Z_1 / Z_2 ) ) ).</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(float, float)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if model 1 does not have chains added.</p></li>
<li><p><strong>ValueError</strong> – Raised if model 2 does not have chains added.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div><div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0"></div><div aria-labelledby="tab-0-0-3" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-3" name="0-3" role="tabpanel" tabindex="0"><span class="target" id="module-harmonic.logs"></span><dl class="py function">
<dt class="sig sig-object py" id="harmonic.logs.critical_log">
<span class="sig-prename descclassname"><span class="pre">harmonic.logs.</span></span><span class="sig-name descname"><span class="pre">critical_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.logs.critical_log" title="Permalink to this definition"></a></dt>
<dd><p>Log a critical message (e.g. core code failures etc).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>message</strong> – Message to log.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="harmonic.logs.debug_log">
<span class="sig-prename descclassname"><span class="pre">harmonic.logs.</span></span><span class="sig-name descname"><span class="pre">debug_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.logs.debug_log" title="Permalink to this definition"></a></dt>
<dd><p>Log a debug message (e.g. for background logs to assist debugging).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>message</strong> – Message to log.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="harmonic.logs.info_log">
<span class="sig-prename descclassname"><span class="pre">harmonic.logs.</span></span><span class="sig-name descname"><span class="pre">info_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.logs.info_log" title="Permalink to this definition"></a></dt>
<dd><p>Log an information message (e.g. evidence value printing, run completion
etc).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>message</strong> – Message to log.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="harmonic.logs.setup_logging">
<span class="sig-prename descclassname"><span class="pre">harmonic.logs.</span></span><span class="sig-name descname"><span class="pre">setup_logging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">custom_yaml_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.logs.setup_logging" title="Permalink to this definition"></a></dt>
<dd><p>initialise and configure logging.</p>
<p>Should be called at the beginning of code to initialise and configure the
desired logging level. Logging levels can be ints in [0,50] where 10 is
debug logging and 50 is critical logging.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>custom_yaml_path</strong> (<em>string</em>) – Complete pathname of desired yaml logging
configuration. If empty will provide default logging config.</p></li>
<li><p><strong>default_level</strong> (<em>int</em>) – Logging level at which to configure.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if logging.yaml is not in ./logs/ directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="harmonic.logs.warning_log">
<span class="sig-prename descclassname"><span class="pre">harmonic.logs.</span></span><span class="sig-name descname"><span class="pre">warning_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.logs.warning_log" title="Permalink to this definition"></a></dt>
<dd><p>Log a warning (e.g. for internal code warnings such as large dynamic
ranges).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>message</strong> – Warning to log.</p>
</dd>
</dl>
</dd></dl>

</div><div aria-labelledby="tab-0-0-4" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-4" name="0-4" role="tabpanel" tabindex="0"><span class="target" id="module-harmonic.utils"></span><dl class="py function">
<dt class="sig sig-object py" id="harmonic.utils.cross_validation">
<span class="sig-prename descclassname"><span class="pre">harmonic.utils.</span></span><span class="sig-name descname"><span class="pre">cross_validation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">chains</span></em>, <em class="sig-param"><span class="pre">domains</span></em>, <em class="sig-param"><span class="pre">hyper_parameters</span></em>, <em class="sig-param"><span class="pre">nfold=2</span></em>, <em class="sig-param"><span class="pre">modelClass=&lt;class</span> <span class="pre">'harmonic.model_legacy.KernelDensityEstimate'&gt;</span></em>, <em class="sig-param"><span class="pre">seed=-1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.utils.cross_validation" title="Permalink to this definition"></a></dt>
<dd><p>Perform n-fold validation for given model using chains to be split into
validation and training data.</p>
<p>First, splits data into nfold chunks. Second, fits the model using each of
the hyper-parameters given using all but one of the chunks (the validation
chunk). This procedure is performed for all the chunks and the average
(mean) log-space variance from all the chunks is computed and returned.
This can be used to decide which hyper-parameters list was better.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chains</strong> (<a class="reference internal" href="#harmonic.Chains" title="harmonic.Chains"><em>Chains</em></a>) – Chains containing samples (to be split into
training and validation data herein).</p></li>
<li><p><strong>domains</strong> (<em>list</em>) – Domains of the model’s parameters.</p></li>
<li><p><strong>hyper_parameters</strong> (<em>list</em>) – List of hyper_parameters where each entry is a
hyper_parameter list to be considered.</p></li>
<li><p><strong>modelClass</strong> (<em>Model</em>) – Model that is being cross validated (default =
KernelDensityEstimate).</p></li>
<li><p><strong>seed</strong> (<em>long</em>) – Seed for random number generator when drawing the chains
(if this is negative the seed is not set).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mean log validation variance (averaged over nfolds) for each hyper-parameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(list)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if model is not one of the posible models.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="harmonic.utils.split_data">
<span class="sig-prename descclassname"><span class="pre">harmonic.utils.</span></span><span class="sig-name descname"><span class="pre">split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_proportion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.utils.split_data" title="Permalink to this definition"></a></dt>
<dd><p>Split the data in a chains instance into two (e.g. training and test sets).</p>
<p>New chains instances can be used for training and calculation the evidence
on the “test” set.</p>
<p>Chains are split so that the first chains in the original chains object go
into the training set and the following go into the test set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chains</strong> (<a class="reference internal" href="#harmonic.Chains" title="harmonic.Chains"><em>Chains</em></a>) – Instance of a chains class containing the data to be split.</p></li>
<li><p><strong>training_proportion</strong> (<em>double</em>) – Proportion of data to be used in training
(default=0.5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A tuple containing the following two Chains.</p>
<blockquote>
<div><ul class="simple">
<li><p>chains_train (Chains): Instance of a chains class containing
chains to be used to fit the model (e.g. training).</p></li>
<li><p>chains_test (Chains): Instance of a chains class containing
chains to be used to calculate the evidence (e.g. testing).</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference internal" href="#harmonic.Chains" title="harmonic.Chains">Chains</a>, <a class="reference internal" href="#harmonic.Chains" title="harmonic.Chains">Chains</a>)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if training_proportion is not strictly between 0 and
    1.</p></li>
<li><p><strong>ValueError</strong> – Raised if resulting nchains in training set is less than 1.</p></li>
<li><p><strong>ValueError</strong> – Raised if resulting nchains in test set is less than 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="harmonic.utils.validation_fit_indexes">
<span class="sig-prename descclassname"><span class="pre">harmonic.utils.</span></span><span class="sig-name descname"><span class="pre">validation_fit_indexes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_fold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchains_in_val_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indexes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.utils.validation_fit_indexes" title="Permalink to this definition"></a></dt>
<dd><p>Extract the correct indexes for the chains of the validation and training
sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i_fold</strong> (<em>long</em>) – Cross-validation iteration to perform.</p></li>
<li><p><strong>nchains_in_val_set</strong> (<em>long</em>) – The number of chains that will go in each
validation set.</p></li>
<li><p><strong>nfold</strong> (<em>long</em>) – Number of fold validation sets to be made.</p></li>
<li><p><strong>indexes</strong> (<em>list</em>) – List of the chains to be used in fold validation that
need to be split.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A tuple containing the following two lists of indices.</p>
<blockquote>
<div><ul class="simple">
<li><p>indexes_val (list): List of indexes for the validation set.</p></li>
<li><p>indexes_fit (list): List of indexes for the training set.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(list, list)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if the value of i_fold does not fall between 0 and
    nfold-1.</p>
</dd>
</dl>
</dd></dl>

</div></div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../tutorials/checkpointing.html" class="btn btn-neutral float-left" title="Checkpointing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Jason D. McEwen, Christopher G. R. Wallis, Matthew A. Price, Matthew M. Docherty.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>