<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; Harmonic 1.0.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom_tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/dark_mode_css/general.css" type="text/css" />
      <link rel="stylesheet" href="../_static/dark_mode_css/dark.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="../_static/dark_mode_js/default_light.js"></script>
        <script src="../_static/dark_mode_js/theme_switcher.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/harm_badge_simple.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.0.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/install.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../background/Harmonic_Estimator/index.html">Harmonic Mean Estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Machine_Learning/index.html">Learnt Container Function</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Jupyter Notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Benchmark Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Namespaces</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Harmonic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/evidence.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<dl class="py class">
<dt class="sig sig-object py" id="harmonic.Evidence">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">harmonic.</span></span><span class="sig-name descname"><span class="pre">Evidence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nchains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Shifting.MEAN_SHIFT</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence" title="Permalink to this definition"></a></dt>
<dd><p>Compute inverse evidence values from chains, using posterior model.</p>
<p>Multiple chains can be added in sequence (to avoid having to store very
long chains).</p>
<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nchains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Shifting.MEAN_SHIFT</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Construct evidence class for computing inverse evidence values from
set number of chains and initialised posterior model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nchains</strong> (<em>long</em>) – Number of chains that will be used in the
computation.</p></li>
<li><p><strong>model</strong> (<em>Model</em>) – An instance of a posterior model class that has
been fitted.</p></li>
<li><p><strong>shift</strong> (<a class="reference internal" href="index.html#harmonic.Shifting" title="harmonic.Shifting"><em>Shifting</em></a>) – What shifting method to use to avoid over/underflow during
computation. Selected from enumerate class.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the number of chains is not positive.</p></li>
<li><p><strong>ValueError</strong> – Raised if the number of dimensions is not positive.</p></li>
<li><p><strong>ValueError</strong> – Raised if model not fitted.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.add_chains">
<span class="sig-name descname"><span class="pre">add_chains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chains</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.add_chains" title="Permalink to this definition"></a></dt>
<dd><p>Add new chains and calculate an estimate of the inverse evidence, its
variance, and the variance of the variance.</p>
<p>Calculations are performed by using running averages of the totals for
each chain. Consequently, the method can be called many times with new
samples for each chain so that the evidence estimate will improve. The
rationale is that not all samples need to be stored in memory for
high-dimensional problems.  Note that the same number of chains needs to
be considered for each call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chains</strong> – An instance of the chains class containing the chains to
be used in the calculation.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the input number of chains to not match the
    number of chains already set up.</p></li>
<li><p><strong>ValueError</strong> – Raised if both max and mean shift are set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.check_basic_diagnostic">
<span class="sig-name descname"><span class="pre">check_basic_diagnostic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.check_basic_diagnostic" title="Permalink to this definition"></a></dt>
<dd><p>Perform basic diagonstic check on sanity of evidence calculations.</p>
<p>If these tests pass it does <em>not</em> necessarily mean the evidence is
accurate and other tests should still be performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether diagnostic tests pass.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Boolean</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>Warnings</strong> – Raised if the diagnostic tests fail.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.compute_evidence">
<span class="sig-name descname"><span class="pre">compute_evidence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.compute_evidence" title="Permalink to this definition"></a></dt>
<dd><p>Compute evidence from the inverse evidence.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>Tuple containing the following.</p>
<blockquote>
<div><ul class="simple">
<li><p>evidence (double): Estimate of evidence.</p></li>
<li><p>evidence_std (double): Estimate of standard deviation of
evidence.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(double, double)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.compute_ln_evidence">
<span class="sig-name descname"><span class="pre">compute_ln_evidence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.compute_ln_evidence" title="Permalink to this definition"></a></dt>
<dd><p>Compute log_e of evidence from the inverse evidence.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>Tuple containing the following.</p>
<blockquote>
<div><ul class="simple">
<li><p>ln_evidence (double): Estimate of log_e of evidence.</p></li>
<li><dl class="simple">
<dt>ln_evidence_std (double): Estimate of log_e of standard</dt><dd><p>deviation of evidence.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(double, double)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.deserialize">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">deserialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.deserialize" title="Permalink to this definition"></a></dt>
<dd><p>Deserialize Evidence object from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>string</em>) – Name of file from which to read evidence object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evidence object deserialized from file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference internal" href="index.html#harmonic.Evidence" title="harmonic.Evidence">Evidence</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.process_run">
<span class="sig-name descname"><span class="pre">process_run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.process_run" title="Permalink to this definition"></a></dt>
<dd><p>Use the running totals of realspace running_sum and nsamples_per_chain to
calculate an estimate of the inverse evidence, its variance, and the
variance of the variance.</p>
<p>This method is ran each time chains are added to update the inverse
variance estimates from the running totals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.serialize">
<span class="sig-name descname"><span class="pre">serialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.serialize" title="Permalink to this definition"></a></dt>
<dd><p>Serialize evidence object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>string</em>) – Name of file to save evidence object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Evidence.set_shift">
<span class="sig-name descname"><span class="pre">set_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shift_value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.set_shift" title="Permalink to this definition"></a></dt>
<dd><p>Set the shift value of log_e posterior values to aid numerical stability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shift_value</strong> (<em>double</em>) – Shift value.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if shift_value is NaN.</p></li>
<li><p><strong>ValueError</strong> – Raised if one attempts to set shift when another
    shift is already set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="harmonic.Shifting">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">harmonic.</span></span><span class="sig-name descname"><span class="pre">Shifting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Shifting" title="Permalink to this definition"></a></dt>
<dd><p>Enumeration to define which log-space shifting to adopt. Different choices
may prove optimal for certain settings.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="harmonic.Shifting.ABS_MAX_SHIFT">
<span class="sig-name descname"><span class="pre">ABS_MAX_SHIFT</span></span><em class="property"> <span class="pre">=</span> <span class="pre">4</span></em><a class="headerlink" href="#harmonic.Shifting.ABS_MAX_SHIFT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="harmonic.Shifting.MAX_SHIFT">
<span class="sig-name descname"><span class="pre">MAX_SHIFT</span></span><em class="property"> <span class="pre">=</span> <span class="pre">2</span></em><a class="headerlink" href="#harmonic.Shifting.MAX_SHIFT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="harmonic.Shifting.MEAN_SHIFT">
<span class="sig-name descname"><span class="pre">MEAN_SHIFT</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1</span></em><a class="headerlink" href="#harmonic.Shifting.MEAN_SHIFT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="harmonic.Shifting.MIN_SHIFT">
<span class="sig-name descname"><span class="pre">MIN_SHIFT</span></span><em class="property"> <span class="pre">=</span> <span class="pre">3</span></em><a class="headerlink" href="#harmonic.Shifting.MIN_SHIFT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<span class="target" id="module-harmonic.evidence"></span><dl class="py function">
<dt class="sig sig-object py" id="harmonic.evidence.compute_bayes_factor">
<span class="sig-prename descclassname"><span class="pre">harmonic.evidence.</span></span><span class="sig-name descname"><span class="pre">compute_bayes_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.evidence.compute_bayes_factor" title="Permalink to this definition"></a></dt>
<dd><p>Compute Bayes factor of two models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ev1</strong> (<em>double</em>) – Evidence object of model 1 with chains added.</p></li>
<li><p><strong>ev2</strong> (<em>double</em>) – Evidence object of model 2 with chains added.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple containing the following.</p>
<blockquote>
<div><ul class="simple">
<li><p>bf12: Estimate of the Bayes factor Z_1 / Z_2.</p></li>
<li><dl class="simple">
<dt>bf12_std: Estimate of the standard deviation of the Bayes factor</dt><dd><p>sqrt( var ( Z_1 / Z_2 ) ).</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(double, double)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if model 1 does not have chains added.</p></li>
<li><p><strong>ValueError</strong> – Raised if model 2 does not have chains added.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="harmonic.evidence.compute_ln_bayes_factor">
<span class="sig-prename descclassname"><span class="pre">harmonic.evidence.</span></span><span class="sig-name descname"><span class="pre">compute_ln_bayes_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.evidence.compute_ln_bayes_factor" title="Permalink to this definition"></a></dt>
<dd><p>Computes log_e of Bayes factor of two models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ev1</strong> (<em>double</em>) – Evidence object of model 1 with chains added.</p></li>
<li><p><strong>ev2</strong> (<em>double</em>) – Evidence object of model 2 with chains added.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple containing the following.</p>
<blockquote>
<div><ul class="simple">
<li><p>ln_bf12: Estimate of log_e of the Bayes factor ln ( Z_1 / Z_2 ).</p></li>
<li><dl class="simple">
<dt>ln_bf12_std: Estimate of log_e of the standard deviation of the</dt><dd><p>Bayes factor ln ( sqrt( var ( Z_1 / Z_2 ) ) ).</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(double, double)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if model 1 does not have chains added.</p></li>
<li><p><strong>ValueError</strong> – Raised if model 2 does not have chains added.</p></li>
</ul>
</dd>
</dl>
</dd></dl>



           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Jason D. McEwen, Christopher G. R. Wallis, Matthew A. Price, Matthew M. Docherty.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>