

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Evidence &mdash; Harmonic 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Utils" href="utils.html" />
    <link rel="prev" title="Model" href="model.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Harmonic
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/overview.html">Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="chains.html">Chains</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Evidence</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="logs.html">Logging</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Harmonic</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Evidence</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/evidence.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="evidence">
<span id="api-evidence"></span><h1>Evidence<a class="headerlink" href="#evidence" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="harmonic.Evidence">
<em class="property">class </em><code class="descclassname">harmonic.</code><code class="descname">Evidence</code><a class="headerlink" href="#harmonic.Evidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute inverse evidence values from chains, using posterior model.</p>
<p>Multiple chains can be added in sequence (to avoid having to store very
long chains).</p>
<dl class="attribute">
<dt id="harmonic.Evidence.__init__">
<code class="descname">__init__</code><a class="headerlink" href="#harmonic.Evidence.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct evidence class for computing inverse evidence values from
set number of chains and initialised posterior model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nchains</strong> (<em>long</em>) – Number of chains that will be used in the
computation.</li>
<li><strong>model</strong> (<em>Model</em>) – An instance of a posterior model class that has
been fitted.</li>
<li><strong>shift</strong> (<a class="reference internal" href="#harmonic.Shifting" title="harmonic.Shifting"><em>Shifting</em></a>) – What shifting method to use to avoid over/underflow during
computation. Selected from enumerate class.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if the number of chains is not positive.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if the number of dimensions is not positive.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if model not fitted.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Evidence.add_chains">
<code class="descname">add_chains</code><a class="headerlink" href="#harmonic.Evidence.add_chains" title="Permalink to this definition">¶</a></dt>
<dd><p>Add new chains and calculate an estimate of the inverse evidence, its
variance, and the variance of the variance.</p>
<p>Calculations are performed by using running averages of the totals for
each chain. Consequently, the method can be called many times with new
samples for each chain so that the evidence estimate will improve. The
rationale is that not all samples need to be stored in memory for
high-dimensional problems.  Note that the same number of chains needs to
be considered for each call.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>chains</strong> – An instance of the chains class containing the chains to
be used in the calculation.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if the input number of chains to not match the
number of chains already set up.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if both max and mean shift are set.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Evidence.check_basic_diagnostic">
<code class="descname">check_basic_diagnostic</code><a class="headerlink" href="#harmonic.Evidence.check_basic_diagnostic" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform basic diagonstic check on sanity of evidence calculations.</p>
<p>If these tests pass it does <em>not</em> necessarily mean the evidence is
accurate and other tests should still be performed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Whether diagnostic tests pass.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Boolean</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Warnings</span></code> – Raised if the diagnostic tests fail.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Evidence.compute_evidence">
<code class="descname">compute_evidence</code><a class="headerlink" href="#harmonic.Evidence.compute_evidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute evidence from the inverse evidence.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Tuple containing the following.<blockquote>
<div><ul class="simple">
<li>evidence (double): Estimate of evidence.</li>
<li>evidence_std (double): Estimate of standard deviation of
evidence.</li>
</ul>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(double, double)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Evidence.compute_ln_evidence">
<code class="descname">compute_ln_evidence</code><a class="headerlink" href="#harmonic.Evidence.compute_ln_evidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute log_e of evidence from the inverse evidence.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Tuple containing the following.<blockquote>
<div><ul class="simple">
<li>ln_evidence (double): Estimate of log_e of evidence.</li>
<li><dl class="first docutils">
<dt>ln_evidence_std (double): Estimate of log_e of standard</dt>
<dd>deviation of evidence.</dd>
</dl>
</li>
</ul>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(double, double)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="harmonic.Evidence.deserialize">
<em class="property">classmethod </em><code class="descname">deserialize</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Evidence.deserialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Deserialize Evidence object from file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>string</em>) – Name of file from which to read evidence object.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Evidence object deserialized from file.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(<a class="reference internal" href="#harmonic.Evidence" title="harmonic.Evidence">Evidence</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Evidence.process_run">
<code class="descname">process_run</code><a class="headerlink" href="#harmonic.Evidence.process_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the running totals of realspace running_sum and nsamples_per_chain to
calculate an estimate of the inverse evidence, its variance, and the
variance of the variance.</p>
<p>This method is ran each time chains are added to update the inverse
variance estimates from the running totals.</p>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Evidence.serialize">
<code class="descname">serialize</code><a class="headerlink" href="#harmonic.Evidence.serialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialize evidence object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>string</em>) – Name of file to save evidence object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Evidence.set_shift">
<code class="descname">set_shift</code><a class="headerlink" href="#harmonic.Evidence.set_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the shift value of log_e posterior values to aid numerical stability.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>shift_value</strong> (<em>double</em>) – Shift value.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if shift_value is NaN.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if one attempts to set shift when another
shift is already set.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="harmonic.Shifting">
<em class="property">class </em><code class="descclassname">harmonic.</code><code class="descname">Shifting</code><a class="headerlink" href="#harmonic.Shifting" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumeration to define which log-space shifting to adopt. Different choices
may prove optimal for certain settings.</p>
<dl class="attribute">
<dt id="harmonic.Shifting.ABS_MAX_SHIFT">
<code class="descname">ABS_MAX_SHIFT</code><em class="property"> = 4</em><a class="headerlink" href="#harmonic.Shifting.ABS_MAX_SHIFT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="harmonic.Shifting.MAX_SHIFT">
<code class="descname">MAX_SHIFT</code><em class="property"> = 2</em><a class="headerlink" href="#harmonic.Shifting.MAX_SHIFT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="harmonic.Shifting.MEAN_SHIFT">
<code class="descname">MEAN_SHIFT</code><em class="property"> = 1</em><a class="headerlink" href="#harmonic.Shifting.MEAN_SHIFT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="harmonic.Shifting.MIN_SHIFT">
<code class="descname">MIN_SHIFT</code><em class="property"> = 3</em><a class="headerlink" href="#harmonic.Shifting.MIN_SHIFT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<span class="target" id="module-harmonic.evidence"></span><dl class="function">
<dt id="harmonic.evidence.compute_bayes_factor">
<code class="descclassname">harmonic.evidence.</code><code class="descname">compute_bayes_factor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.evidence.compute_bayes_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Bayes factor of two models.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ev1</strong> (<em>double</em>) – Evidence object of model 1 with chains added.</li>
<li><strong>ev2</strong> (<em>double</em>) – Evidence object of model 2 with chains added.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>Tuple containing the following.</p>
<blockquote>
<div><ul class="simple">
<li>bf12: Estimate of the Bayes factor Z_1 / Z_2.</li>
<li><dl class="first docutils">
<dt>bf12_std: Estimate of the standard deviation of the Bayes factor</dt>
<dd>sqrt( var ( Z_1 / Z_2 ) ).</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">(double, double)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if model 1 does not have chains added.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if model 2 does not have chains added.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="harmonic.evidence.compute_ln_bayes_factor">
<code class="descclassname">harmonic.evidence.</code><code class="descname">compute_ln_bayes_factor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.evidence.compute_ln_bayes_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes log_e of Bayes factor of two models.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ev1</strong> (<em>double</em>) – Evidence object of model 1 with chains added.</li>
<li><strong>ev2</strong> (<em>double</em>) – Evidence object of model 2 with chains added.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>Tuple containing the following.</p>
<blockquote>
<div><ul class="simple">
<li>ln_bf12: Estimate of log_e of the Bayes factor ln ( Z_1 / Z_2 ).</li>
<li><dl class="first docutils">
<dt>ln_bf12_std: Estimate of log_e of the standard deviation of the</dt>
<dd>Bayes factor ln ( sqrt( var ( Z_1 / Z_2 ) ) ).</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">(double, double)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if model 1 does not have chains added.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if model 2 does not have chains added.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="utils.html" class="btn btn-neutral float-right" title="Utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="model.html" class="btn btn-neutral" title="Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Jason D. McEwen, Christopher G. R. Wallis, Matthew A. Price.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>