<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; Harmonic 1.2.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=798747b0" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom_tabs.css?v=82e1095b" />
      <link rel="stylesheet" type="text/css" href="../_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="../_static/dark_mode_css/dark.css?v=70edf1c7" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=fd7cadf9"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="../_static/dark_mode_js/default_light.js?v=c2e647ce"></script>
        <script src="../_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/harm_badge_simple.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.2.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/install.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../background/Harmonic_Estimator/original_harmonic_mean.html">Harmonic mean estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Harmonic_Estimator/retargetd_harmonic_mean.html">Re-targeted harmonic mean estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Harmonic_Estimator/learnt_harmonic_mean.html">Learnt harmonic mean estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Machine_Learning/index.html">Learning a suitable target distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Bayes_Factors/bayes_factors.html">Bayes factors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Log_space_statistics/log_variance.html">Log-space variance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/basic_usage.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/checkpointing.html">Checkpointing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Namespaces</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Harmonic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/model_legacy.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <dl class="py class" id="module-harmonic.model_legacy">
<dt class="sig sig-object py" id="harmonic.model_legacy.HyperSphere">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">harmonic.model_legacy.</span></span><span class="sig-name descname"><span class="pre">HyperSphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.HyperSphere" title="Link to this definition"></a></dt>
<dd><p>HyperSphere Model to approximate the log_e posterior by a hyper-ellipsoid.</p>
<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.HyperSphere.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.HyperSphere.__init__" title="Link to this definition"></a></dt>
<dd><p>Constructor setting the parameters of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_in</strong> (<em>long</em>) – Dimension of the problem to solve.</p></li>
<li><p><strong>domains</strong> (<em>list</em>) – A list of length 1 containing a 1D array of length
2 containing the lower and upper bound of the radius of the
hyper-sphere.</p></li>
<li><p><strong>hyper_parameters</strong> (<em>None</em>) – Should not be set as there are no
hyper-parameters for this model (in general, however, models can
have hyper-parameters).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the hyper_parameters variable is not None.</p></li>
<li><p><strong>ValueError</strong> – If the length of domains list is not one.</p></li>
<li><p><strong>ValueError</strong> – If the ndim_in is not positive.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.HyperSphere.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.HyperSphere.fit" title="Link to this definition"></a></dt>
<dd><p>Fit the parameters of the model (i.e. its radius).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>double ndarray</em><em>[</em><em>nsamples</em><em>, </em><em>ndim</em><em>]</em>) – Sample x coordinates.</p></li>
<li><p><strong>Y</strong> (<em>double ndarray</em><em>[</em><em>nsamples</em><em>]</em>) – Target log_e posterior values for each
sample in X.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple containing the following objects.</p>
<blockquote>
<div><ul class="simple">
<li><p>success (bool): Whether fit successful.</p></li>
<li><p>objective (double): Value of objective at optimal point.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(bool, double)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the first dimension of X is not the same as
    Y.</p></li>
<li><p><strong>ValueError</strong> – Raised if the second dimension of X is not the same as
    ndim.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.HyperSphere.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.HyperSphere.predict" title="Link to this definition"></a></dt>
<dd><p>Use model to predict the value of log_e posterior at point x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>double</em>) – Sample of which to predict posterior value.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted posterior value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(double)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.HyperSphere.set_R">
<span class="sig-name descname"><span class="pre">set_R</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.HyperSphere.set_R" title="Link to this definition"></a></dt>
<dd><p>Set the radius of the hyper-sphere and calculate its volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>R</strong> (<em>double</em>) – The radius of the hyper-sphere.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the radius is a NaN.</p></li>
<li><p><strong>ValueError</strong> – If the radius is not positive.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.HyperSphere.set_centre">
<span class="sig-name descname"><span class="pre">set_centre</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centre_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.HyperSphere.set_centre" title="Link to this definition"></a></dt>
<dd><p>Set centre of the hyper-sphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>centre_in</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>]</em>) – Centre of sphere.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the length of the centre array is not the same as
    ndim.</p></li>
<li><p><strong>ValueError</strong> – If the centre array contains a NaN.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.HyperSphere.set_inv_covariance">
<span class="sig-name descname"><span class="pre">set_inv_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inv_covariance_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.HyperSphere.set_inv_covariance" title="Link to this definition"></a></dt>
<dd><p>Set diagonal inverse covariances for the hyper-sphere.</p>
<p>Only diagonal covariance structure is supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inv_covariance_in</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>]</em>) – Diagonal of inverse
covariance matrix that defines the ellipse.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the length of the inv_covariance array is not equal
    to ndim.</p></li>
<li><p><strong>ValueError</strong> – If the inv_covariance array contains a NaN.</p></li>
<li><p><strong>ValueError</strong> – If the inv_covariance array contains a value that is
    not positive.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.HyperSphere.set_precomputed_values">
<span class="sig-name descname"><span class="pre">set_precomputed_values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.HyperSphere.set_precomputed_values" title="Link to this definition"></a></dt>
<dd><p>Precompute volume of the hyper-sphere (scaled ellipse) and squared radius.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="harmonic.model_legacy.KernelDensityEstimate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">harmonic.model_legacy.</span></span><span class="sig-name descname"><span class="pre">KernelDensityEstimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.1]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.KernelDensityEstimate" title="Link to this definition"></a></dt>
<dd><p>KernelDensityEstimate model to approximate the log_e posterior using kernel
density estimation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.KernelDensityEstimate.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.1]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.KernelDensityEstimate.__init__" title="Link to this definition"></a></dt>
<dd><p>Constructor setting the hyper-parameters and domains of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ndim</strong> (<em>long</em>) – Dimension of the problem to solve.</p></li>
<li><p><strong>domains</strong> (<em>list</em>) – List of length 0 since domain not considered for
Kernel Density Estimation.</p></li>
<li><p><strong>hyper_parameters</strong> (<em>list</em>) – A list of length 1 containing the diameter
in scaled units of the hyper-spheres to use in the Kernel
Density Estimate.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the hyper_parameters list is not length 1.</p></li>
<li><p><strong>ValueError</strong> – If the length of domains list is not 0.</p></li>
<li><p><strong>ValueError</strong> – If the ndim_in is not positive.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.KernelDensityEstimate.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.KernelDensityEstimate.fit" title="Link to this definition"></a></dt>
<dd><p>Fit the parameters of the model.</p>
<p>Fit is performed as follows.</p>
<p>Set the scales of the model from the samples.</p>
<p>Create the dictionary containing all the information on which samples
are in which pixel in a grid where each pixel size is the same as the
diameter of the hyper-spheres to be placed on each sample.</p>
<p>The key is an index of the grid (c type ordering) and the value is a
list containing the indexes in the sample array of all the samples in
that index 3.</p>
<p>Precompute the normalisation factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>double ndarray</em><em>[</em><em>nsamples</em><em>, </em><em>ndim</em><em>]</em>) – Sample x coordinates.</p></li>
<li><p><strong>Y</strong> (<em>double ndarray</em><em>[</em><em>nsamples</em><em>]</em>) – Target log_e posterior values for each
sample in X.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether fit successful.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(bool)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the first dimension of X is not the same as Y.</p></li>
<li><p><strong>ValueError</strong> – Raised if the second dimension of X is not the same as
    ndim.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.KernelDensityEstimate.precompute_normalising_factor">
<span class="sig-name descname"><span class="pre">precompute_normalising_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.KernelDensityEstimate.precompute_normalising_factor" title="Link to this definition"></a></dt>
<dd><p>Precompute the log_e normalisation factor of the density estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>double ndarray</em><em>[</em><em>nsamples</em><em>, </em><em>ndim</em><em>]</em>) – Sample x coordinates.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if the second dimension of X is not the same as
    ndim.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.KernelDensityEstimate.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.KernelDensityEstimate.predict" title="Link to this definition"></a></dt>
<dd><p>Predict the value of the posterior at point x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>]</em>) – 1D array of sample of shape (ndim) to predict
posterior value.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted log_e posterior value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(double)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.KernelDensityEstimate.set_scales">
<span class="sig-name descname"><span class="pre">set_scales</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.KernelDensityEstimate.set_scales" title="Link to this definition"></a></dt>
<dd><p>Set the scales of the hyper-spheres based on the min and max sample in each
dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>double ndarray</em><em>[</em><em>nsamples</em><em>, </em><em>ndim</em><em>]</em>) – Sample x coordinates.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if the second dimension of X is not the same as
    ndim.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="harmonic.model_legacy.ModifiedGaussianMixtureModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">harmonic.model_legacy.</span></span><span class="sig-name descname"><span class="pre">ModifiedGaussianMixtureModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[3,</span> <span class="pre">1e-08,</span> <span class="pre">None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.ModifiedGaussianMixtureModel" title="Link to this definition"></a></dt>
<dd><p>ModifiedGaussianMixtureModel (MGMM) to approximate the log_e posterior by a
modified Gaussian mixture model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.ModifiedGaussianMixtureModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[3,</span> <span class="pre">1e-08,</span> <span class="pre">None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.ModifiedGaussianMixtureModel.__init__" title="Link to this definition"></a></dt>
<dd><p>Constructor setting the hyper-parameters and domains of the model of the
MGMM which models the posterior as a group of Gaussians.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ndim</strong> (<em>long</em>) – Dimension of the problem to solve.</p></li>
<li><p><strong>domains</strong> (<em>list</em>) – A list of length 1 with the range of scale
parameter of the covariance matrix, i.e. the range of alpha,
where C’ = alpha * C_samples, and C_samples is the diagonal of
the covariance in the samples in each cluster.</p></li>
<li><p><strong>hyper_parameters</strong> (<em>list</em>) – A list of length 5, the first of which
should be number of clusters, the second is the regularisation
parameter gamma, the third is the learning rate, the fourth is
the maximum number of iterations and the fifth is the batch
size.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the hyper_parameters list is not length 5.</p></li>
<li><p><strong>ValueError</strong> – Raised if the length of domains list is not 1.</p></li>
<li><p><strong>ValueError</strong> – Raised if the ndim is not positive.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.ModifiedGaussianMixtureModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.ModifiedGaussianMixtureModel.fit" title="Link to this definition"></a></dt>
<dd><p>Fit the parameters of the model as follows.</p>
<p>If centres and inv_covariances not set:
- Find clusters using the k-means clustering from scikit learn.
- Use the samples in the clusters to find the centres and covariance
matricies.</p>
<p>Then minimize the objective function using the gradients and mini-batch
stochastic descent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>double ndarray</em><em>[</em><em>nsamples</em><em>, </em><em>ndim</em><em>]</em>) – Sample x coordinates.</p></li>
<li><p><strong>Y</strong> (<em>double ndarray</em><em>[</em><em>nsamples</em><em>]</em>) – Target log_e posterior values for each
sample in X.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether fit successful.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(bool)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the first dimension of X is not the same as
    Y.</p></li>
<li><p><strong>ValueError</strong> – Raised if the first dimension of X is not the same as
    Y.</p></li>
<li><p><strong>ValueError</strong> – Raised if the second dimension of X is not the same
    as ndim.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.ModifiedGaussianMixtureModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.ModifiedGaussianMixtureModel.predict" title="Link to this definition"></a></dt>
<dd><p>Predict the value of the posterior at point x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>]</em>) – Sample of shape (ndim) at which to
predict posterior value.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted log_e posterior value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(double)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.ModifiedGaussianMixtureModel.set_alphas">
<span class="sig-name descname"><span class="pre">set_alphas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alphas_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.ModifiedGaussianMixtureModel.set_alphas" title="Link to this definition"></a></dt>
<dd><p>Set the alphas (i.e. scales).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>alphas_in</strong> (<em>double ndarray</em><em>[</em><em>ngaussians</em><em>]</em>) – Alpha scalings.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the input array length is not ngaussians.</p></li>
<li><p><strong>ValueError</strong> – Raised if the input array contains a NaN.</p></li>
<li><p><strong>ValueError</strong> – Raised if at least one of the alphas not positive.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.ModifiedGaussianMixtureModel.set_centres">
<span class="sig-name descname"><span class="pre">set_centres</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centres_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.ModifiedGaussianMixtureModel.set_centres" title="Link to this definition"></a></dt>
<dd><p>Set the centres of the Gaussians.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>centres_in</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>, </em><em>ngaussians</em><em>]</em>) – Centres.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the input array is not the correct shape.</p></li>
<li><p><strong>ValueError</strong> – Raised if the input array contains a NaN.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.ModifiedGaussianMixtureModel.set_centres_and_inv_covariance">
<span class="sig-name descname"><span class="pre">set_centres_and_inv_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centres_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_covariance_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.ModifiedGaussianMixtureModel.set_centres_and_inv_covariance" title="Link to this definition"></a></dt>
<dd><p>Set the centres and inverse covariance of the Gaussians.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>centres_in</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>, </em><em>ngaussians</em><em>]</em>) – Centres.</p></li>
<li><p><strong>inv_covariance</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>, </em><em>ngaussians</em><em>]</em>) – Inverse
covariance of the Gaussians.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the input arrays are not the correct shape.</p></li>
<li><p><strong>ValueError</strong> – Raised if the input arrays contain a NaN.</p></li>
<li><p><strong>ValueError</strong> – Raised if the input covariance contains a number that
    is not positive.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.ModifiedGaussianMixtureModel.set_inv_covariance">
<span class="sig-name descname"><span class="pre">set_inv_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inv_covariance_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.ModifiedGaussianMixtureModel.set_inv_covariance" title="Link to this definition"></a></dt>
<dd><p>Set the inverse covariance of the Gaussians.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inv_covariance</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>, </em><em>ngaussians</em><em>]</em>) – Inverse
covariance of the Gaussians.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the input array is not the correct shape.</p></li>
<li><p><strong>ValueError</strong> – Raised if the input array contains a NaN.</p></li>
<li><p><strong>ValueError</strong> – Raised if the input array contains a number that is
    not positive.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.model_legacy.ModifiedGaussianMixtureModel.set_weights">
<span class="sig-name descname"><span class="pre">set_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights_in</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.ModifiedGaussianMixtureModel.set_weights" title="Link to this definition"></a></dt>
<dd><p>Set the weights of the Gaussians.</p>
<p>The weights are the softmax of the betas (without normalisation), i.e.
the betas are the log_e of the weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>weights_in</strong> (<em>double ndarray</em><em>[</em><em>ngaussians</em><em>]</em>) – 1D array containing the
weights (no need to normalise).</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if the input array length is not ngaussians.</p></li>
<li><p><strong>ValueError</strong> – Raised if the input array contains a NaN.</p></li>
<li><p><strong>ValueError</strong> – Raised if at least one of the weights is negative.</p></li>
<li><p><strong>ValueError</strong> – Raised if the sum of the weights is too close to
    zero.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="harmonic.model_legacy.beta_to_weights_wrap">
<span class="sig-prename descclassname"><span class="pre">harmonic.model_legacy.</span></span><span class="sig-name descname"><span class="pre">beta_to_weights_wrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngaussians</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.beta_to_weights_wrap" title="Link to this definition"></a></dt>
<dd><p>Wrapper to calculate the weights from the beta_weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>double ndarray</em><em>[</em><em>ngaussians</em><em>]</em>) – Beta values to be converted.</p></li>
<li><p><strong>ngaussians</strong> (<em>long</em>) – The number of Gaussians in the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Weight values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(double ndarray[ngaussians])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="harmonic.model_legacy.calculate_gaussian_normalisation_wrap">
<span class="sig-prename descclassname"><span class="pre">harmonic.model_legacy.</span></span><span class="sig-name descname"><span class="pre">calculate_gaussian_normalisation_wrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.calculate_gaussian_normalisation_wrap" title="Link to this definition"></a></dt>
<dd><p>Wrapper to calculate the normalisation for evaluate_one_gaussian.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<em>double</em>) – The scaling parameter of the covariance matrix.</p></li>
<li><p><strong>inv_covariance</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>]</em>) – Diagonal of inverse
covariance matrix.</p></li>
<li><p><strong>ndim</strong> (<em>long</em>) – Dimension of the problem.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The normalisation factor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(double)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="harmonic.model_legacy.delta_theta_ij_wrap">
<span class="sig-prename descclassname"><span class="pre">harmonic.model_legacy.</span></span><span class="sig-name descname"><span class="pre">delta_theta_ij_wrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.delta_theta_ij_wrap" title="Link to this definition"></a></dt>
<dd><p>Wrapper to evaluate delta_theta_ij squared which is part of the gradient of
the objective function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>]</em>) – Position of current sample.</p></li>
<li><p><strong>mu</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>]</em>) – Centre of the Gaussian.</p></li>
<li><p><strong>inv_covariance</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>]</em>) – Diagonal of inverse
covariance matrix.</p></li>
<li><p><strong>ndim</strong> (<em>long</em>) – Dimension of the problem.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of delta_theta_ij squared.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(double)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="harmonic.model_legacy.evaluate_one_gaussian_wrap">
<span class="sig-prename descclassname"><span class="pre">harmonic.model_legacy.</span></span><span class="sig-name descname"><span class="pre">evaluate_one_gaussian_wrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.model_legacy.evaluate_one_gaussian_wrap" title="Link to this definition"></a></dt>
<dd><p>Wrapper to evaluate one Gaussian.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>]</em>) – Postion where the Gaussian is to be
evaluated.</p></li>
<li><p><strong>mu</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>]</em>) – Centre of the Gaussian.</p></li>
<li><p><strong>inv_covariance</strong> (<em>double ndarray</em><em>[</em><em>ndim</em><em>]</em>) – Diagonal of inverse
covariance matrix.</p></li>
<li><p><strong>alpha</strong> (<em>double</em>) – Scaling parameter of the covariance matrix.</p></li>
<li><p><strong>weight</strong> (<em>double</em>) – Weight applied to that Gaussian.</p></li>
<li><p><strong>ndim</strong> (<em>long</em>) – Dimension of the problem.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Height of the Gaussian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(double)</p>
</dd>
</dl>
</dd></dl>



           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Jason D. McEwen, Christopher G. R. Wallis, Matthew A. Price, Matthew M. Docherty, Alicja Polanska.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>