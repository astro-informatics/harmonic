<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; Harmonic 1.1.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom_tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/dark_mode_css/general.css" type="text/css" />
      <link rel="stylesheet" href="../_static/dark_mode_css/dark.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="../_static/dark_mode_js/default_light.js"></script>
        <script src="../_static/dark_mode_js/theme_switcher.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/harm_badge_simple.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/install.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../background/Harmonic_Estimator/original_harmonic_mean.html">Harmonic mean estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Harmonic_Estimator/retargetd_harmonic_mean.html">Re-targeted harmonic mean estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Harmonic_Estimator/learnt_harmonic_mean.html">Learnt harmonic mean estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Machine_Learning/index.html">Learning a suitable target distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Bayes_Factors/bayes_factors.html">Bayes factors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/Log_space_statistics/log_variance.html">Log-space variance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/basic_usage.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cross-validation_hyper-parameters.html">Hyper-parameter cross-validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cross-validation_learnt_model.html">Model cross-validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/checkpointing.html">Checkpointing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Namespaces</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Harmonic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/chains.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <dl class="py class">
<dt class="sig sig-object py" id="harmonic.Chains">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">harmonic.</span></span><span class="sig-name descname"><span class="pre">Chains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains" title="Permalink to this definition"></a></dt>
<dd><p>Class to store samples from multiple MCMC chains.</p>
<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Construct empty Chains for parameter space of dimension ndim.</p>
<p>Constructor simply sets ndim. Chain samples are added by the add_chain*
methods since we want to support setting up data for chains from
different input data formats (e.g. data from a single chain or multiple
chains at once).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ndim</strong> (<em>int</em>) – Dimension of the parameter space.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.add" title="Permalink to this definition"></a></dt>
<dd><p>Add other Chain object to this object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="index.html#harmonic.Chains" title="harmonic.Chains"><em>Chains</em></a>) – Other Chain object to be added to this object.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if the new chain has a different ndim.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.add_chain">
<span class="sig-name descname"><span class="pre">add_chain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ln_posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.add_chain" title="Permalink to this definition"></a></dt>
<dd><p>Add a single chain to a Chains object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em><em>[</em><em>nsamples</em><em>, </em><em>ndim</em><em>]</em>) – Samples of a single
chain.</p></li>
<li><p><strong>ln_posterior</strong> (<em>np.ndarray</em><em>[</em><em>n_new_samples</em><em>]</em>) – log_e posterior
values.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised when ndim of new chain does not match previous
    chains.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.add_chains_2d">
<span class="sig-name descname"><span class="pre">add_chains_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ln_posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchains_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.add_chains_2d" title="Permalink to this definition"></a></dt>
<dd><p>Add a number of chains to a Chains object assuming all chains are
of the same length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em><em>[</em><em>nsamples_in * nchains_in</em><em>, </em><em>ndim</em><em>]</em>) – Samples
of multiple chains.</p></li>
<li><p><strong>ln_posterior</strong> (<em>np.ndarray</em><em>[</em><em>nsamples_in * nchains_in</em><em>]</em>) – log_e
posterior values.</p></li>
<li><p><strong>nchains_in</strong> (<em>int</em>) – Number of chains to be added.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised when number of samples is not multiple of the
    number of chains.</p></li>
<li><p><strong>ValueError</strong> – Raised when ndim of new chains does not match previous
    chains.</p></li>
<li><p><strong>ValueError</strong> – Raised when posterior and samples first length are
    different.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.add_chains_2d_list">
<span class="sig-name descname"><span class="pre">add_chains_2d_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ln_posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchains_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_indexes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.add_chains_2d_list" title="Permalink to this definition"></a></dt>
<dd><p>Add a number of chains to the chain class. Uses a list of indexes to
determine where each chain starts and stops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em><em>[</em><em>nsamples_in * nchains_in</em><em>, </em><em>ndim</em><em>]</em>) – Samples
of multiple chains.</p></li>
<li><p><strong>ln_posterior</strong> (<em>np.ndarray</em><em>[</em><em>nsamples_in * nchains_in</em><em>]</em>) – log_e
posterior values.</p></li>
<li><p><strong>nchains_in</strong> (<em>int</em>) – Number of chains to be added.</p></li>
<li><p><strong>chain_indexes</strong> (<em>list</em>) – List of the starting index of the chains.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised when ndim of new chains does not match
    previous chains.</p></li>
<li><p><strong>ValueError</strong> – Raised when posterior and samples first length are
    different.</p></li>
<li><p><strong>ValueError</strong> – Raised when the length of the list is not nchains_in
    + 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.add_chains_3d">
<span class="sig-name descname"><span class="pre">add_chains_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ln_posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.add_chains_3d" title="Permalink to this definition"></a></dt>
<dd><p>Add a number of chains to a Chain object from 3D array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em><em>[</em><em>nchains_in</em><em>, </em><em>nsamples_in</em><em>, </em><em>ndim</em><em>]</em>) – Samples
from multiple chains.</p></li>
<li><p><strong>ln_posterior</strong> (<em>np.ndarray</em><em>[</em><em>nchains_in</em><em>, </em><em>nsamples_in</em><em>]</em>) – log_e
posterior values.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised when ndim of new chains does not match previous
    chains.</p></li>
<li><p><strong>ValueError</strong> – Raised when posterior and samples first and second
    length are different.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.deepcopy">
<span class="sig-name descname"><span class="pre">deepcopy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.deepcopy" title="Permalink to this definition"></a></dt>
<dd><p>Performs deep copy of the chain class (calls the module copy).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.get_chain_indices">
<span class="sig-name descname"><span class="pre">get_chain_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.get_chain_indices" title="Permalink to this definition"></a></dt>
<dd><p>Gets the start and end index of samples from a chain.</p>
<p>The end index specifies the index one passed the end of the chain, i.e.
the chain samples can be accessed by self.samples[start:end,:].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> (<em>int</em>) – Index of chain of which to determine start and end indices.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of the start and end index, i.e. (start, end).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(int, int)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised when chain number invalid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.get_sub_chains">
<span class="sig-name descname"><span class="pre">get_sub_chains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chains_wanted</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.get_sub_chains" title="Permalink to this definition"></a></dt>
<dd><p>Creates a new chain instance with the chains indexed in chains_wanted.
(Useful for cross-validation.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chains_wanted</strong> (<em>List</em>) – List of indexes of chains that the new
chain instance will contain.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Chains object containing the chains wanted.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="index.html#harmonic.Chains" title="harmonic.Chains">Chains</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the chains_wanted indexes are out of bounds
    i.e. outside of range 0 to nchains - 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.nsamples_per_chain">
<span class="sig-name descname"><span class="pre">nsamples_per_chain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.nsamples_per_chain" title="Permalink to this definition"></a></dt>
<dd><p>Compute list containing number of samples in each chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None.</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>1D list of length self.nchains containing the</dt><dd><p>number of samples in each chain.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nsamples_per_chain (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.remove_burnin">
<span class="sig-name descname"><span class="pre">remove_burnin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nburn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.remove_burnin" title="Permalink to this definition"></a></dt>
<dd><p>Remove burn-in samples from each chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nburn</strong> (<em>int</em>) – Number of burn-in samples to remove from each chain.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised when nburn not less then number of samples in
    each chain.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.shallowcopy">
<span class="sig-name descname"><span class="pre">shallowcopy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.shallowcopy" title="Permalink to this definition"></a></dt>
<dd><p>Performs shallow copy of the chain class (calls the module copy).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="harmonic.Chains.split_into_blocks">
<span class="sig-name descname"><span class="pre">split_into_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nblocks</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#harmonic.Chains.split_into_blocks" title="Permalink to this definition"></a></dt>
<dd><p>Split chains into larger number of blocks.</p>
<p>The intention of this method is to break chains into blocks that are
(approximately) independent in order to get more independent chains for
computing various statistics.</p>
<p>Each existing chain is split into blocks (i.e. new chains),
proportionally to the size of the current chains. Final blocks within
each chain end up containing slightly different numbers of samples
(since we do not ever want to throw away samples!). One could improve
this, if required, to distribute the additional samples across all of
the blocks of the chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nblocks</strong> (<em>int</em>) – Number of new (blocked) chains to split existing chains
into.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Returned if nblocks &lt; the number chains</p>
</dd>
</dl>
</dd></dl>

</dd></dl>



           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Jason D. McEwen, Christopher G. R. Wallis, Matthew A. Price, Matthew M. Docherty.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>