

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Chains &mdash; Harmonic 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Model" href="model.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Harmonic
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/overview.html">Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/basic_usage.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/checkpointing.html">Checkpointing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cross-validation_hyper-parameters.html">Cross-validation for hyper-parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cross-validation_learnt_model.html">Cross-validation for learnt model</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/overview.html">Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Chains</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="evidence.html">Evidence</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="logs.html">Logging</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Harmonic</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Chains</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/chains.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="chains">
<span id="api-chains"></span><h1>Chains<a class="headerlink" href="#chains" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="harmonic.Chains">
<em class="property">class </em><code class="descclassname">harmonic.</code><code class="descname">Chains</code><a class="headerlink" href="#harmonic.Chains" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to store samples from multiple MCMC chains.</p>
<dl class="attribute">
<dt id="harmonic.Chains.__init__">
<code class="descname">__init__</code><a class="headerlink" href="#harmonic.Chains.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct empty Chains for parameter space of dimension ndim.</p>
<p>Constructor simply sets ndim. Chain samples are added by the add_chain*
methods since we want to support setting up data for chains from
different input data formats (e.g. data from a single chain or multiple
chains at once).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ndim</strong> (<em>long</em>) – Dimension of the parameter space.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Chains.add">
<code class="descname">add</code><a class="headerlink" href="#harmonic.Chains.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add other Chain object to this object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<a class="reference internal" href="#harmonic.Chains" title="harmonic.Chains"><em>Chains</em></a>) – Other Chain object to be added to this object.</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if the new chain has a different ndim.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Chains.add_chain">
<code class="descname">add_chain</code><a class="headerlink" href="#harmonic.Chains.add_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a single chain to a Chains object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>samples</strong> (<em>double ndarray</em><em>[</em><em>nsamples</em><em>, </em><em>ndim</em><em>]</em>) – Samples of a single
chain.</li>
<li><strong>ln_posterior</strong> (<em>double ndarray</em><em>[</em><em>n_new_samples</em><em>]</em>) – log_e posterior
values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised when ndim of new chain does not match previous
chains.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Chains.add_chains_2d">
<code class="descname">add_chains_2d</code><a class="headerlink" href="#harmonic.Chains.add_chains_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a number of chains to a Chains object assuming all chains are
of the same length.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>samples</strong> (<em>double ndarray</em><em>[</em><em>nsamples_in * nchains_in</em><em>, </em><em>ndim</em><em>]</em>) – Samples
of multiple chains.</li>
<li><strong>ln_posterior</strong> (<em>double ndarray</em><em>[</em><em>nsamples_in * nchains_in</em><em>]</em>) – log_e
posterior values.</li>
<li><strong>nchains_in</strong> (<em>long</em>) – Number of chains to be added.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised when number of samples is not multiple of the
number of chains.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised when ndim of new chains does not match previous
chains.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised when posterior and samples first length are
different.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Chains.add_chains_2d_list">
<code class="descname">add_chains_2d_list</code><a class="headerlink" href="#harmonic.Chains.add_chains_2d_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a number of chains to the chain class. Uses a list of indexes to
determine where each chain starts and stops.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>samples</strong> (<em>double ndarray</em><em>[</em><em>nsamples_in * nchains_in</em><em>, </em><em>ndim</em><em>]</em>) – Samples
of multiple chains.</li>
<li><strong>ln_posterior</strong> (<em>double ndarray</em><em>[</em><em>nsamples_in * nchains_in</em><em>]</em>) – log_e
posterior values.</li>
<li><strong>nchains_in</strong> (<em>long</em>) – Number of chains to be added.</li>
<li><strong>chain_indexes</strong> (<em>list</em>) – List of the starting index of the chains.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised when ndim of new chains does not match
previous chains.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised when posterior and samples first length are
different.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised when the length of the list is not nchains_in
+ 1.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Chains.add_chains_3d">
<code class="descname">add_chains_3d</code><a class="headerlink" href="#harmonic.Chains.add_chains_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a number of chains to a Chain object from 3D array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>samples</strong> (<em>double ndarray</em><em>[</em><em>(</em><em>nchains_in</em><em>, </em><em>nsamples_in</em><em>, </em><em>ndim</em><em>]</em>) – Samples
from multiple chains.</li>
<li><strong>ln_posterior</strong> (<em>double ndarray</em><em>[</em><em>nchains_in</em><em>, </em><em>nsamples_in</em><em>]</em>) – log_e
posterior values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised when ndim of new chains does not match previous
chains.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised when posterior and samples first and second
length are different.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Chains.copy">
<code class="descname">copy</code><a class="headerlink" href="#harmonic.Chains.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs deep copy of the chain class (calls the module copy).</p>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Chains.get_chain_indices">
<code class="descname">get_chain_indices</code><a class="headerlink" href="#harmonic.Chains.get_chain_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the start and end index of samples from a chain.</p>
<p>The end index specifies the index one passed the end of the chain, i.e.
the chain samples can be accessed by self.samples[start:end,:].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>i</strong> (<em>long</em>) – Index of chain of which to determine start and end indices.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A tuple of the start and end index, i.e. (start, end).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(long, long)</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised when chain number invalid.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Chains.get_sub_chains">
<code class="descname">get_sub_chains</code><a class="headerlink" href="#harmonic.Chains.get_sub_chains" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new chain instance with the chains indexed in chains_wanted.
(Useful for cross validation.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>chains_wanted</strong> (<em>list</em>) – List of indexes of chains that the new
chain instance will contain.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Chains object containing the chains wanted.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#harmonic.Chains" title="harmonic.Chains">Chains</a></td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – If any of the chains_wanted indexes are out of bounds
i.e. outside of range 0 to nchains - 1.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Chains.nsamples_per_chain">
<code class="descname">nsamples_per_chain</code><a class="headerlink" href="#harmonic.Chains.nsamples_per_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute list containing number of samples in each chain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>None.</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>1D list of length self.nchains containing the</dt>
<dd>number of samples in each chain.</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">nsamples_per_chain (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Chains.remove_burnin">
<code class="descname">remove_burnin</code><a class="headerlink" href="#harmonic.Chains.remove_burnin" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove burn-in samples from each chain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nburn</strong> (<em>int</em>) – Number of burn-in samples to remove from each chain.</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised when nburn not less then number of samples in
each chain.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="harmonic.Chains.split_into_blocks">
<code class="descname">split_into_blocks</code><a class="headerlink" href="#harmonic.Chains.split_into_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Split chains into larger number of blocks.</p>
<p>The intention of this method is to break chains into blocks that are
(approximately) independent in order to get more independent chains for
computing various statistics.</p>
<p>Each existing chain is split into blocks (i.e. new chains),
proportionally to the size of the current chains. Final blocks within
each chain end up containing slightly different numbers of samples
(since we do not ever want to throw away samples!). One could improve
this, if required, to distribute the additional samples across all of
the blocks of the chain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nblocks</strong> (<em>int</em>) – Number of new (blocked) chains to split existing chains
into.</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Returned if nblocks &lt; the number chains</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="model.html" class="btn btn-neutral float-right" title="Model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="overview.html" class="btn btn-neutral" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Jason D. McEwen, Christopher G. R. Wallis, Matthew A. Price.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="../None"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>